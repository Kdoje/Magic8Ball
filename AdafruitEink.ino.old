#include <Adafruit_GFX.h>
#include <Adafruit_EPD.h>
#include <GxEPD2_BW.h>

// Pin definitions
#define EINK_CS    10
#define EINK_DC    9
#define EINK_RST   8
#define EINK_BUSY  7

#define MAX_SPI_CLOCK 1000000


// Use UC8151 (also known as IL0373) driver
GxEPD2_BW<GxEPD2_200, GxEPD2_200::HEIGHT> display(GxEPD2_200(EINK_CS, EINK_DC, EINK_RST, EINK_BUSY));

void setup() {
  pinMode(7, INPUT);
  pinMode(8, OUTPUT);
  pinMode(9, OUTPUT);
  pinMode(10, OUTPUT);

  Serial.begin(9600);
  while(!Serial);
  display.init();  // 2MHz SPI
  display.setRotation(0);

  display.firstPage();
    Serial.println("Starting updated!");
  do {
    display.fillScreen(GxEPD_WHITE);
    display.setTextSize(2);
    display.setTextColor(GxEPD_BLACK);
    display.setCursor(20, 50);
    display.print("GxEPD2 Test32");
  } while (display.nextPage());

  Serial.println("Display updated!");
}


void loop() {
  Serial.print("BUSY Pin State: ");
  Serial.println(digitalRead(7));  
}
